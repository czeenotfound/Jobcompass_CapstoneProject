{% extends 'users/base.html' %}
{% block title %}Job Compass | Home {% endblock %}
{% load humanize %}
{% load static %}
{% load widget_tweaks %}

{% block content %}
    <!-- Add CSS styles for progress bars to fix linter errors -->
    <style>
        /* Fix for progress bars */
        .progress {
            display: flex;
            height: 1rem;
            overflow: hidden;
            font-size: .75rem;
            background-color: #e9ecef;
            border-radius: 0.25rem;
        }

        .progress-bar {
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
            color: #fff;
            text-align: center;
            white-space: nowrap;
            background-color: #0d6efd;
            transition: width .6s ease;
        }

        .progress-bar.bg-success {
            background-color: #198754 !important;
        }

        .progress-bar.bg-warning {
            background-color: #ffc107 !important;
        }

        .progress-bar.bg-info {
            background-color: #0dcaf0 !important;
        }

        .progress-bar.bg-danger {
            background-color: #dc3545 !important;
        }

        .circular-progress {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
    </style>

    {% if request.user.is_applicant %}
    
    {% if not request.user.has_resume %}
        <div class="custombreadcrumb container alert alert-danger mt-3 p-4" role="alert">
            Register your resume first. <a href="{% url 'create-resume' %}" class="text-decoration-none">Register Resume</a>
        </div>
        <!-- Welcome  -->
        <div class="d-flex align-items-center">
            <section class="container h-100 p-5 bg-light rounded-start mb-4">
                <h1 class="hero-heading">Welcome to Our Platform</h1>
                <p class="hero-subheading">Discover amazing opportunities and connect with the best companies.</p>
            </section>
        </div> 
    {% endif %}
        {% if not request.user.has_resume %}
            <div class="mb-5" style="height: 500px;"></div>
        {% endif %}
        {% if request.user.has_resume %}
        <div class="container">
            <!-- SEARCH FILTERING -->
            <div class="banner mb-4">
                <form class="row justify-content-center" method="GET">
                    <div class="col-md-10">
                        <div class="bubbleformfilter d-flex gap-3 align-items-center">
                            <i class="fa-solid fa-magnifying-glass text-dark"></i>
                            {% render_field job_filter.form.title class="searchbar form-control form-control-lg border-0 p-0" placeholder="Search for jobs..." %}
                            <button class="searchbar btn btn-primary custom-button" type="submit">Search</button>
                            <a href="{% url 'dashboard' %}" class="searchbar btn btn-outline-secondary custom-button">Reset</a>
                        </div>
                    </div>
                    
                    <div class="row g-3 mb-4 justify-content-center text-center input-group">
                        <!-- Location Filter -->
                        <div class="col-xs-12 col-sm-6 col-md-4">
                            <label for="location">Location</label>
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-location-dot text-dark"></i>
                                {% render_field job_filter.form.location class="form-control border-0 p-0" placeholder="region, city, street" %}
                            </div>
                        </div>
                        
                        <!-- Job Type Filter -->
                        <div class="col-xs-12 col-sm-6 col-md-4">
                            <label for="jobType">Job Type</label>
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-briefcase text-dark"></i>
                                {% render_field job_filter.form.employment_job_type class="form-control border-0 p-0" %}
                            </div>
                        </div>
                        
                        <!-- Education Level Filter -->
                        <div class="col-xs-12 col-sm-6 col-md-4">
                            <label for="education">Education Level</label>
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-graduation-cap text-dark"></i>
                                {% render_field job_filter.form.education_level class="form-control border-0 p-0" %}
                            </div>
                        </div>
                        
                        <!-- Experience Filter -->
                        <div class="col-xs-12 col-sm-6 col-md-6">
                            <label for="experience">Experience (Years)</label>
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-clock-rotate-left text-dark"></i>
                                {% render_field job_filter.form.experience type="number" min="0" class="form-control border-0 p-0" placeholder="Enter years" %}
                            </div>
                        </div>
                        <!-- Salary Type Filter -->
                        <div class="col-xs-12 col-sm-6 col-md-6">
                            <label for="salaryType">Salary Type</label>
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-money-bill-wave text-dark"></i>
                                <select name="salary_display_type" class="form-control border-0 p-0" id="salaryType">
                                    <option value="" selected>Select Salary Type</option>
                                    {% for value, text in job_filter.form.salary_display_type.field.choices %}
                                        {% if value %}
                                            <option value="{{ value }}" {% if job_filter.form.salary_display_type.value == value %}selected{% endif %}>
                                                {{ text }}
                                            </option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <!-- Fixed Salary Input (Initially Hidden) -->
                        <div class="col-xs-12 col-sm-6 col-md-6" id="fixedSalaryContainer" style="display: none;">
                            <label for="minSalary">Fixed Salary</label>
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-money-bill-1 text-dark"></i>
                                {% render_field job_filter.form.min_salary type="number" class="form-control border-0 p-0" placeholder="Enter Fixed Salary" %}
                            </div>
                        </div>

                        <!-- Salary Range Inputs (Initially Hidden) -->
                        <div id="salaryRangeContainer" class="row mt-2" style="display: none;">
                            <div class="col-xs-12 col-sm-6 col-md-6">
                                <label for="minSalary">Minimum Salary</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-money-bill-1 text-dark"></i>
                                    {% render_field job_filter.form.min_salary type="number" class="form-control border-0 p-0" placeholder="Min Salary" %}
                                </div>
                            </div>

                            <div class="col-xs-12 col-sm-6 col-md-6">
                                <label for="maxSalary">Maximum Salary</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-money-bill-1-wave text-dark"></i>
                                    {% render_field job_filter.form.max_salary type="number" class="form-control border-0 p-0" placeholder="Max Salary" %}
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="row mb-5">
                <!-- Job Listings Column -->
                <div class="d-flex justify-content-between align-items-center mt-3 mb-3">
                    <h3 class="mb-1 mx-2">Jobs For You</h3>
                    <p>{{ recommended_jobs_count }} results found</p>
                </div> 
                
                <!-- Recommended Jobs Column -->
                <div class="col-md-5">
                    <div class="job-listings">
                        {% for job in recommended_jobs %}
                        <div class="card job-card mb-3" data-id="{{ forloop.counter }}" onclick="showJobDetails(this)">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-4">
                                    <div class="d-flex align-items-center">
                                        <img src="{{ job.company.avatar.url }}" alt="CompanyLogo" class="img-fluid rounded-circle company-logo me-3">
                                        <div>
                                            <h5 class="mb-1 fw-bolder">{{ job.title }}</h5>
                                            <p class="text-muted mb-0">{{ job.company }}</p>
                                            <p class="text-muted mb-0" style="font-size: 12px;">
                                                {{ job.location }}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-2">
                                    <ul class="list-unstyled mb-0">
                                        <li>
                                            <span class="text-dark p-2"><i class="fas fa-clock me-2"></i> {{ job.employment_job_type|title }}</span>
                                        </li>
                                        <li>
                                            <span class="text-dark p-2"><i class="fas fa-map-marker-alt me-2"></i> {{ job.location_job_type|title }}</span>
                                        </li>
                                        <li>
                                            {% if job.salary_display_type == 'fixed' %}
                                                <span class="text-dark p-2">
                                                    <i class="fa-solid fa-money-bill-wave me-2"></i>
                                                    {{ job.currency }} {{ job.salary_fixed|intcomma }} {{job.salary_mode|title}}
                                                </span>
                                            {% elif job.salary_display_type == 'range' %}
                                                <span class="text-dark p-2">
                                                    <i class="fa-solid fa-money-bill-wave me-2"></i>
                                                    {{ job.currency }} {{ job.salary_min|intcomma }} - {{ job.currency }} {{ job.salary_max|intcomma }} {{job.salary_mode|title}}
                                                </span>
                                            {% elif job.salary_display_type == 'hidden' %}
                                            
                                            {% else %}
                                                <p>No Salary Information Available</p>
                                            {% endif %}
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-footer bg-white" style="border-top: none;" title="{{ job.posted_date_time|date:'F d, Y H:i:s' }}">
                                <span>Posted {{ job.posted_date_time|naturaltime }}</span>
                            </div>
                        </div>
                    {% empty %}
                        <div class="customAlert alert alert-danger text-center p-4 shadow" role="alert">
                            <h4>No recommended jobs found</h4>
                            <p class="mt-2">Please adjust your filters and try again.</p>
                        </div>
                    {% endfor %}
                    </div>
                </div>
                
                <div class="col-md-7">
                    {% for job in recommended_jobs %}
                        <div id="job-{{ forloop.counter }}" class="job-details {% if forloop.first %} active {% endif %}">
                            <div class="card job-card-details">
                                <div class="card-body p-4">
                                    <div class="d-flex justify-content-between align-items-start mb-4">
                                        <div class="d-flex align-items-center">
                                            <img src="{{job.company.avatar.url}}" alt="CompanyLogo" class="img-fluid rounded-circle company-logo me-3">
                                            <div>
                                                <a href="{% url 'job-info' job.pk %}" class="joblink fs-2 text-decoration-none mb-1 fw-bolder">{{job.title}}</a>
                                                <p class="text-muted mb-0">{{job.company}}</p>
                                                <span class="text-muted mb-0">{{job.location_job_type|title}}</span>
                                            </div>
                                        </div>
                                        <!-- Add Best Match and Not Suitable Labels -->
                                        <div>
                                            {% if forloop.first %}
                                                <span class="badge bg-success text-white">Best Match</span>
                                            {% endif %}
                                            {% if job.not_suitable %}
                                                <span class="badge bg-danger text-white">Not Suitable</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <style>
                                        .circular-progress {
                                            width: 50px;
                                            height: 50px;
                                            border-radius: 50%;
                                            display: flex;
                                            align-items: center;
                                            justify-content: center;
                                            color: white;
                                            font-weight: bold;
                                        }
                                    </style>
                                    
                                    <div class="d-flex flex-column mb-4">
                                        <div class="d-flex align-items-center mb-1">
                                            <div class="icon-container me-3 d-flex justify-content-center align-items-center" style="min-width: 30px;">
                                                <i class="fa-solid fa-location-dot text-mute"></i>
                                            </div>
                                            <span> 
                                                {{ job.location }}
                                            </span>
                                        </div>
                                        <div class="d-flex align-items-center mb-1">
                                            <div class="icon-container me-3 d-flex justify-content-center align-items-center" style="min-width: 30px;">
                                                <i class="fa-solid fa-building"></i>
                                            </div>
                                            <span>{{job.industry|title}}</span>
                                        </div>
                                        <div class="d-flex align-items-center mb-1">
                                            <div class="icon-container me-3 d-flex justify-content-center align-items-center" style="min-width: 30px;">
                                                <i class="fa-regular fa-clock"></i>
                                            </div>
                                            <div>{{job.employment_job_type|title}}</div>
                                        </div>

                                        {% if job.salary_display_type == 'fixed' %}
                                            <div class="d-flex align-items-center">
                                                <div class="icon-container me-3 d-flex justify-content-center align-items-center" style="min-width: 30px;">
                                                    <i class="fa-solid fa-money-bill-wave"></i>
                                                </div>
                                                <div>{{ job.currency }} {{ job.salary_fixed|intcomma }} {{job.salary_mode|title}}</div>
                                            </div>
                                        {% elif job.salary_display_type == 'range' %}
                                            <div class="d-flex align-items-center">
                                                <div class="icon-container me-3 d-flex justify-content-center align-items-center" style="min-width: 30px;">
                                                    <i class="fa-solid fa-money-bill-wave"></i>
                                                </div>
                                                <div>{{ job.currency }} {{ job.salary_min|intcomma }} - {{ job.currency }} {{ job.salary_max|intcomma }} {{job.salary_mode|title}}</div>
                                            </div>
                                        {% elif job.salary_display_type == 'hidden' %}

                                        {% else %}
                                            <p>No Salary Information Available</p>
                                        {% endif %}
                                    </div>

                                     <!-- Add Not Suitable Warning in Details -->
                                    {% if job.not_suitable %}
                                        <div class="alert alert-danger mt-3">
                                            <i class="fas fa-exclamation-triangle"></i> Your skills do not match the requirements for this job.
                                        </div>
                                    {% endif %}

                                    

                                    <!-- Detailed Match Card -->
                                    <div class="card mb-3 border-primary shadow-sm">
                                        <!-- Collapsible Header -->
                                        <div class="card-header bg-primary bg-opacity-10 text-primary">
                                            <div class="d-flex justify-content-between align-items-center" 
                                                 data-bs-toggle="collapse" 
                                                 data-bs-target="#matchDetailsCollapse{{ job.id }}" 
                                                 aria-expanded="false" 
                                                 aria-controls="matchDetailsCollapse{{ job.id }}"
                                                 style="cursor: pointer;">
                                                <div class="text-white">
                                                    <i class="fas fa-chart-bar me-2"></i>Match Analysis
                                                </div>
                                                <div class="d-flex align-items-center">
                                                    <span class="badge bg-primary rounded-pill me-2">{{ job.total_score }}</span>
                                                    <i class="fas fa-chevron-down collapse-icon"></i>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Collapsed Content -->
                                        <div class="collapse" id="matchDetailsCollapse{{ job.id }}">
                                            <div class="card-body p-3">
                                                <!-- Primary Matches -->
                                                <div class="row mb-3">
                                                    <div class="col-md-4">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="me-2">
                                                                <div class="circular-progress {% if job.industry_match == 1 %}bg-success{% else %}bg-danger{% endif %} d-flex align-items-center justify-content-center" style="width: 32px; height: 32px; border-radius: 50%;">
                                                                    <i class="fas {% if job.industry_match == 1 %}fa-check{% else %}fa-times{% endif %} text-white small"></i>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <h6 class="fw-bold mb-0 small">Industry</h6>
                                                                <p class="text-muted mb-0 small">
                                                                    {% if job.industry_match == 1 %}
                                                                        {{ resume.industry }}
                                                                    {% else %}
                                                                        Not matched
                                                                    {% endif %}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="me-2">
                                                                <div class="circular-progress {% if job.employment_match == 1 %}bg-success{% else %}bg-danger{% endif %} d-flex align-items-center justify-content-center" style="width: 32px; height: 32px; border-radius: 50%;">
                                                                    <i class="fas {% if job.employment_match == 1 %}fa-check{% else %}fa-times{% endif %} text-white small"></i>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <h6 class="fw-bold mb-0 small">Employment Type</h6>
                                                                <p class="text-muted mb-0 small">
                                                                    {% if job.employment_match == 1 %}
                                                                        {{ resume.employment_job_type }}
                                                                    {% else %}
                                                                        Not matched
                                                                    {% endif %}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="me-2">
                                                                <div class="circular-progress {% if job.location_match == 1 %}bg-success{% else %}bg-danger{% endif %} d-flex align-items-center justify-content-center" style="width: 32px; height: 32px; border-radius: 50%;">
                                                                    <i class="fas {% if job.location_match == 1 %}fa-check{% else %}fa-times{% endif %} text-white small"></i>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <h6 class="fw-bold mb-0 small">Location Type</h6>
                                                                <p class="text-muted mb-0 small">
                                                                    {% if job.location_match == 1 %}
                                                                        {{ resume.location_job_type }}
                                                                    {% else %}
                                                                        Not matched
                                                                    {% endif %}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Secondary Matches -->
                                                <div class="row mb-3">
                                                    <div class="col-md-4">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="me-2">
                                                                <div class="circular-progress {% if job.skill_match_count > 0 %}bg-success{% else %}bg-danger{% endif %} d-flex align-items-center justify-content-center" style="width: 32px; height: 32px; border-radius: 50%;">
                                                                    <span class="text-white fw-bold small">{{ job.skill_match_count }}</span>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <h6 class="fw-bold mb-0 small">Skills</h6>
                                                                <p class="text-muted mb-0 small">{{ job.skill_match_count }}/{{ job.requiredskill_set.count }} skills</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="me-2">
                                                                <div class="circular-progress {% if job.education_match == 1 %}bg-success{% else %}bg-danger{% endif %} d-flex align-items-center justify-content-center" style="width: 32px; height: 32px; border-radius: 50%;">
                                                                    <i class="fas {% if job.education_match == 1 %}fa-check{% else %}fa-times{% endif %} text-white small"></i>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <h6 class="fw-bold mb-0 small">Education</h6>
                                                                <p class="text-muted mb-0 small">
                                                                    {% if job.education_match == 1 %}
                                                                        Qualified
                                                                    {% else %}
                                                                        Not matched
                                                                    {% endif %}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="me-2">
                                                                <div class="circular-progress {% if job.experience_match == 1 %}bg-success{% else %}bg-danger{% endif %} d-flex align-items-center justify-content-center" style="width: 32px; height: 32px; border-radius: 50%;">
                                                                    <i class="fas {% if job.experience_match == 1 %}fa-check{% else %}fa-times{% endif %} text-white small"></i>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <h6 class="fw-bold mb-0 small">Experience</h6>
                                                                <p class="text-muted mb-0 small">
                                                                    {% if job.experience_match == 1 %}
                                                                        Sufficient
                                                                    {% else %}
                                                                        Insufficient
                                                                    {% endif %}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Detailed Breakdown -->
                                                <div class="mb-3">
                                                    <div class="accordion accordion-flush small" id="skillsAccordion{{ job.id }}">
                                                        <div class="accordion-item">
                                                            <h2 class="accordion-header" id="skillsHeading{{ job.id }}">
                                                                <button class="accordion-button collapsed py-2 small fw-bold" type="button" 
                                                                        data-bs-toggle="collapse" data-bs-target="#skillsContent{{ job.id }}" 
                                                                        aria-expanded="false" aria-controls="skillsContent{{ job.id }}">
                                                                    Detailed Breakdown
                                                                </button>
                                                            </h2>
                                                            <div id="skillsContent{{ job.id }}" class="accordion-collapse collapse" 
                                                                aria-labelledby="skillsHeading{{ job.id }}" data-bs-parent="#skillsAccordion{{ job.id }}">
                                                                <div class="accordion-body p-2">
                                                                    <div class="row">
                                                                        <div class="col-md-6">
                                                                            <h6 class="text-success small fw-bold">
                                                                                <i class="fas fa-check-circle me-1"></i>Matching Skills
                                                                            </h6>
                                                                            <ul class="ps-3 small mb-3">
                                                                                {% for match in job.matched_skills %}
                                                                                    <li>
                                                                                        <strong>{{ match.job_skill }}</strong>
                                                                                        {% if match.match_type == 'fuzzy' %}
                                                                                            <span class="text-muted">
                                                                                                ({{ match.similarity }}% match with "{{ match.resume_skill }}")
                                                                                            </span>
                                                                                        {% endif %}
                                                                                    </li>
                                                                                {% empty %}
                                                                                    <li class="text-muted">No matching skills</li>
                                                                                {% endfor %}
                                                                            </ul>
                                                                        </div>
                                                                        <div class="col-md-6">
                                                                            <h6 class="text-danger small fw-bold">
                                                                                <i class="fas fa-times-circle me-1"></i>Missing Skills
                                                                            </h6>
                                                                            <ul class="ps-3 small mb-3">
                                                                                {% for skill in job.unmatched_skills %}
                                                                                    <li>{{ skill }}</li>
                                                                                {% empty %}
                                                                                    <li class="text-success">You have all required skills!</li>
                                                                                {% endfor %}
                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <!-- Education Match Details -->
                                                                    <div class="mt-3">
                                                                        <h6 class="text-primary small fw-bold">
                                                                            <i class="fas fa-graduation-cap me-1"></i>Education Match
                                                                        </h6>
                                                                        {% if job.education_matches %}
                                                                            <ul class="ps-3 small mb-3">
                                                                                {% for match in job.education_matches %}
                                                                                    <li>
                                                                                        {% if match.type == 'level' %}
                                                                                            <span class="text-success">
                                                                                                <i class="fas fa-check-circle me-1"></i>
                                                                                                Education level: {{ match.resume_value }}
                                                                                            </span>
                                                                                        {% elif match.type == 'degree' %}
                                                                                            <span class="text-success">
                                                                                                <i class="fas fa-check-circle me-1"></i>
                                                                                                Degree: {{ match.resume_value }}
                                                                                                {% if match.similarity < 100 %}
                                                                                                    <span class="text-muted">({{ match.similarity }}% match with "{{ match.job_value }}")</span>
                                                                                                {% endif %}
                                                                                            </span>
                                                                                        {% endif %}
                                                                                    </li>
                                                                                {% endfor %}
                                                                            </ul>
                                                                        {% else %}
                                                                            <p class="text-muted small">Your education doesn't match the job requirements.</p>
                                                                        {% endif %}
                                                                    </div>
                                                                    
                                                                     <!-- Experience Match Details -->
                                                                    <div class="mt-3">
                                                                        <h6 class="text-primary small fw-bold">
                                                                            <i class="fas fa-briefcase me-1"></i>Experience Match
                                                                        </h6>
                                                                        {% if job.matched_experiences %}
                                                                            <ul class="ps-3 small mb-3">
                                                                                {% for match in job.matched_experiences %}
                                                                                    <li>
                                                                                        <div class="mb-2">
                                                                                            <strong>{{ match.job_requirement }}</strong>
                                                                                            <span class="text-success ms-2">({{ match.match_score }}% match)</span>
                                                                                            <div class="text-muted">
                                                                                                Matched with your experience: {{ match.best_match.title }} at {{ match.best_match.company }}
                                                                                            </div>
                                                                                            {% if match.years_match %}
                                                                                                <div class="text-success">
                                                                                                    <i class="fas fa-check-circle me-1"></i>
                                                                                                    Required experience: {{ match.years_required }} (You have: {{ match.total_years }} years)
                                                                                                </div>
                                                                                            {% else %}
                                                                                                <div class="text-danger">
                                                                                                    <i class="fas fa-times-circle me-1"></i>
                                                                                                    Required experience: {{ match.years_required }} (You have: {{ match.total_years }} years)
                                                                                                </div>
                                                                                            {% endif %}
                                                                                        </div>
                                                                                    </li>
                                                                                {% endfor %}
                                                                            </ul>
                                                                        {% else %}
                                                                            <p class="text-muted small">No matching experience found for the job requirements.</p>
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-light p-2">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <small class="text-muted">
                                                        <i class="fas fa-info-circle me-1"></i>Based on 6 compatibility factors
                                                    </small>
                                                    <a href="{% url 'create-resume' %}" class="btn btn-sm btn-outline-primary">Improve Match</a>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Non-collapsed summary (always visible) -->
                                        <div class="d-flex align-items-center p-2 bg-light border-top">
                                            <div class="progress flex-grow-1 me-2" style="height: 6px;">
                                                <div class="progress-bar 
                                                    {% if job.best_match %}bg-success
                                                    {% elif job.good_match %}bg-warning
                                                    {% elif job.not_suitable %}bg-danger
                                                    {% else %}bg-info{% endif %}" 
                                                    role="progressbar" 
                                                    style="width: {% widthratio job.total_score job.max_score 100 %}%;" 
                                                    aria-valuenow="{{ job.total_score }}" 
                                                    aria-valuemin="0" 
                                                    aria-valuemax="{{ job.max_score }}">
                                                </div>
                                            </div>
                                            <span class="text-muted small">
                                                {% if job.best_match %}
                                                    <span class="text-success fw-bold">Best Match</span>
                                                {% elif job.good_match %}
                                                    <span class="text-warning fw-bold">Good Match</span>
                                                {% elif job.not_suitable %}
                                                    <span class="text-danger fw-bold">Not Suitable</span>
                                                {% else %}
                                                    <span class="text-info fw-bold">Possible Match</span>
                                                {% endif %}
                                                <span class="ms-1">({{ job.total_score }} out of {{ job.max_score }} points)</span>
                                            </span>
                                        </div>
                                    </div>

                                    {% if user.is_authenticated and user.is_applicant %} 
                                        <div class="mb-4">
                                            {% if job.has_applied %}
                                                {% if job.application_status == 'ACCEPTED' %}
                                                    <a href="#" class="btn btn-success customButton disabled">Application Accepted</a>
                                                {% elif job.application_status == 'REJECTED' %}
                                                    <a href="#" class="btn btn-danger customButton disabled">Application Rejected</a>
                                                {% else %}
                                                    <button type="button" class="btn btn-danger customButton px-4" data-bs-toggle="modal" data-bs-target="#confirmModal" 
                                                        data-action-url="{% url 'unapply-job' job.pk %}">Cancel Application
                                                    </button>
                                                {% endif %}
                                            {% else %}
                                                <a href="{% url 'apply-job' job.pk %}" class="btn btn-primary customButton px-4">Apply</a>
                                            {% endif %}
                                       
                                            {% if job.is_saved %}
                                                <a href="{% url 'save-job' job.pk %}" class="btn btn-secondary disabled customButton px-4"><i class="fa-solid fa-bookmark me-2"></i> Saved</a>
                                            {% else %}
                                                <a href="{% url 'save-job' job.pk %}" class="btn btn-outline-secondary customButton px-4"><i class="fa-solid fa-bookmark me-2"></i> Save</a>
                                            {% endif %}
                                        </div>
                                    {% endif %}

                                    {% if job.job_description %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold">Job Description</h6>
                                            <p>{{job.job_description}}</p>
                                        </div>
                                    {% endif %}
                                    
                                    {% if job.requiredskill_set.exists %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold">Required Skills</h6>
                                            <div class="d-flex flex-wrap">
                                                {% for skill in job.requiredskill_set.all %}
                                                <span class="skillbadge me-2 mb-1">{{ skill.skill_name }}</span>
                                                {% empty %}
                                                <span class="skillbadge me-2 mb-1">No skills listed.</span>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    {% endif %}

                                    {% if job.job_responsibilities_set.exists %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold">Responsibilities</h6>
                                            <ul class="list-unstyled">
                                                {% for responsibility in job.job_responsibilities_set.all %}
                                                    <li class="d-flex align-items-start mb-2">
                                                        <i class="fa-solid fa-check-circle text-primary mt-2 me-2"></i>
                                                        <span>{{ responsibility.res_name }}</span>
                                                    </li>
                                                {% empty %}
                                                    <li class="text-muted">No responsibilities listed</li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}

                                    {% if job.job_education_set.exists %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold mb-2">Educational Attainment</h6>
                                            <ul class="list-unstyled">
                                                {% for education in job.job_education_set.all %}
                                                    <li class="d-flex align-items-start mb-2">
                                                        <i class="fa-solid fa-graduation-cap mt-1 me-2"></i>
                                                        {% if education.degree %}
                                                            <div class="d-flex flex-column">
                                                                <span class="fw-semibold">
                                                                    {{ education.degree|title }}
                                                                </span>
                                                                <span class="text-muted">{{ education.get_education_level_display }}</span>
                                                            </div>
                                                            
                                                        {% endif %}
                                                        
                                                        
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}

                                                   
                                    {% if job.job_idealcandidates_set.exists %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold">Ideal Candidate</h6>
                                            <ul class="list-unstyled">
                                                {% for idealcandidate in job.job_idealcandidates_set.all %}
                                                    <li class="d-flex align-items-start mb-2">
                                                        - {{ idealcandidate.ideal_name }}
                                                    </li>
                                                {% empty %}
                                                    <li>No ideal candidate listed.</li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}

                                    {% if job.job_benefits_set.exists %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold">Benefits</h6>
                                            <ul class="list-unstyled">
                                                {% for benefit in job.job_benefits_set.all %}
                                                    <li class="mb-2">
                                                        - {{ benefit.bene_name }}
                                                    </li>
                                                {% empty %}
                                                    <li>No benefits listed.</li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}

                                    {% if job.job_experience_set.exists %}
                                        <div class="mb-4">
                                            <h6 class="fw-bold">
                                                <i class="bi bi-briefcase-fill"></i> Job Experience
                                            </h6>
                                            <ul class="list-unstyled">
                                                {% for experience in job.job_experience_set.all %}
                                                    <li class="d-flex align-items-start mb-3 px-3">
                                                        <div class="d-flex flex-column">
                                                            <span class="fw-semibold">
                                                                {{ experience.exp_name }}
                                                            </span>
                                                            <!-- Display Fixed or Range Experience -->
                                                            {% if experience.exp_type == 'fixed' and experience.exp_years %}
                                                                <span class="text-muted">{{ experience.exp_years }} year/s of experience</span>
                                                            {% elif experience.exp_type == 'range' and experience.min_exp_years and experience.max_exp_years %}
                                                                <span class="text-muted">{{ experience.min_exp_years }} - {{ experience.max_exp_years }} year/s of experience</span>
                                                            {% endif %}
                                                            
                                                            {% if experience.exp_description %}
                                                                <span class="text-muted">{{ experience.exp_description }}</span>
                                                            {% endif %}
                                                        </div>
                                                    </li>
                                                {% empty %}
                                                    <li class="text-muted">No experience required.</li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% empty %}
                        <div class="customAlert alert alert-danger text-center shadow" role="alert" style="padding: 5rem; margin-bottom: 10vh;">
                            <img src="{% static 'images/undraw_no_data_re_kwbl.svg' %}" class="mb-4" width="150" height="150" alt="">
                            <h3>No results found.</h3>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <!-- END OF JOBS FEED -->
        </div>
        {% endif %}
    {% elif request.user.is_employer %}
    
        {% if not request.user.has_company %}
            <div class="container alert alert-danger mt-3" role="alert">
                <p class="text-dark">Register a company first.</p>
                <a href="{% url 'register-company' %}" class="btn btn-light customButton px-3">
                    <i class="fas fa-plus me-2"></i>Register Company 
                </a>
            </div>
             <!-- Welcome  -->
            <div class="d-flex align-items-center" style="margin-bottom: 50vh;">
                <section class="container h-100 p-5 bg-light rounded-start mb-4">
                    <h1 class="hero-heading">Welcome to Our Platform</h1>
                    <p class="hero-subheading">Discover amazing opportunities and connect with the best applicants.</p>
                </section>
            </div>
        {% else %}
        {% if not is_profile_complete %}
            <div class="container alert alert-danger mt-3" role="alert">
                <p class="text-dark">Your employer profile is incomplete. Set it up now!</p>
                <a href="{% url 'update-employer-profile' %}" class="btn btn-light customButton px-3">
                    <i class="fas fa-plus me-2"></i>Set Up Employer Profile
                </a>
            </div>
        {% endif %}
            
            <!-- Main Section -->
            <div class="container">
                <!-- Banner -->
                <div class="bannercandidate mb-4">
                    <form class="row justify-content-center" method="GET">
                        <div class="col-md-10">
                            <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                <i class="fa-solid fa-magnifying-glass text-dark"></i>
                                {% render_field resume_filter.form.name class="searchbar form-control form-control-lg border-0 p-0" placeholder="Search for Candidates..." %}
                                <button class="searchbar btn btn-primary custom-button" type="submit">Search</button>
                                <a href="{% url 'dashboard' %}" class="searchbar btn btn-outline-secondary custom-button" type="submit">Reset</a>
                            </div>
                        </div>
                        
                        <div class="row g-3 mb-4 justify-content-center text-center input-group">
                            <!-- Location Filter -->
                            <div class="col-xs-12 col-sm-6 col-md-3">
                                <label for="address">Location</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-location-dot text-dark"></i>
                                    <div class="input-group">
                                        {% render_field resume_filter.form.address class="form-control border-0 p-0" placeholder="region, city, street" %}
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Job Type Filter -->
                            <div class="col-xs-12 col-sm-6 col-md-3">
                                <label for="jobType">Employment Type</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-briefcase text-dark"></i>
                                    {% render_field resume_filter.form.employment_job_type class="form-control border-0 p-0" %}
                                </div>
                            </div>
                            
                            <div class="col-xs-12 col-sm-6 col-md-3">
                                <label for="educationLevel">Minimum Education</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-graduation-cap text-dark"></i>
                                    {% render_field resume_filter.form.education_level class="form-control border-0 p-0" %}
                                </div>
                            </div>

                            <!-- Salary Type Filter -->
                            <div class="col-sm-6 col-md-3">
                                <label for="salaryType">Salary Type</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-money-bill-wave text-dark"></i>
                                    <select name="salary_display_type" class="form-control border-0 p-0" id="salaryType">
                                        <option value="" selected>Select Salary Type</option>
                                        {% for value, text in resume_filter.form.salary_display_type.field.choices %}
                                            {% if value %}
                                                <option value="{{ value }}" {% if resume_filter.form.salary_display_type.value == value %}selected{% endif %}>
                                                    {{ text }}
                                                </option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <!-- Fixed Salary Input (Initially Hidden) -->
                            <div class="col-xs-12 col-sm-6 col-md-6" id="fixedSalaryContainer" style="display: none;">
                                <label for="minSalary">Fixed Salary</label>
                                <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                    <i class="fa-solid fa-money-bill-1 text-dark"></i>
                                    {% render_field resume_filter.form.min_salary type="number" class="form-control border-0 p-0" placeholder="Enter Fixed Salary" %}
                                </div>
                            </div>

                            <!-- Salary Range Inputs (Initially Hidden) -->
                            <div id="salaryRangeContainer" class="row mt-2" style="display: none;">
                                <div class="col-xs-12 col-sm-6 col-md-6">
                                    <label for="minSalary">Minimum Salary</label>
                                    <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                        <i class="fa-solid fa-money-bill-1 text-dark"></i>
                                        {% render_field resume_filter.form.min_salary type="number" class="form-control border-0 p-0" placeholder="Min Salary" %}
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-6 col-md-6">
                                    <label for="maxSalary">Maximum Salary</label>
                                    <div class="bubbleformfilter d-flex gap-3 align-items-center">
                                        <i class="fa-solid fa-money-bill-1-wave text-dark"></i>
                                        {% render_field resume_filter.form.max_salary type="number" class="form-control border-0 p-0" placeholder="Max Salary" %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Main content -->
                <div class="row">
                    <!-- Left Column: Candidates -->
                    <div class=" col-md-8 p-4">
                        <h2 class="mb-4">Find Candidates</h2>
                        <p>{{ resume_filtered_count }} results found</p>
                        <!-- Candidate Card Template -->
                        {% for resume in resume_filter.qs %}
                            <div class="card candidate-card mb-3 shadow-sm">
                                <div class="card-body">
                                    <div class="d-flex align-items-center justify-content-center">
                                        <img src="{{resume.avatar.url}}" alt="Candidate" class="rounded-circle me-4 bg-primary" width="80" height="80">
                                        <div>
                                            <h5 class="card-title mb-1 fw-bolder">{{resume.first_name|title}} {{resume.last_name|title}}</h5>
                                            <p class="text-muted mb-2">{{resume.job_position|title}} </p>
                                            
                                        </div>
                                        <div class="ms-auto">
                                            <a href="{% url 'view-resume-profile' resume.pk %}" class="btn btn-outline-primary customButton px-3">
                                                View Profile
                                            </a>
                                        </div>
                                    </div>


                                    <!-- Ultra-compact Job Match Summary -->
                                    {% if resume.matching_jobs %}
                                        <div class="card mt-3 mb-3 border-success">
                                            <div class="card-body bg-opacity-10 p-3">
                                                <div class="d-flex justify-content-between align-items-start">
                                                    <div>
                                                        <h6 class="text-success mb-1">
                                                            <i class="fas fa-star me-2"></i>Recommended Match
                                                        </h6>
                                                        {% with best_match=resume.matching_jobs.0 %}
                                                        <p class="mb-2 fw-bold">{{ best_match.job.title }}</p>
                                                        <div class="d-flex align-items-center mb-2">
                                                            <div class="badge bg-success text-white me-2">{{ best_match.match_score|floatformat:1 }} match points</div>
                                                            <span class="small text-muted">{{ best_match.matching_criteria|join:", " }}</span>
                                                        </div>
                                                        
                                                        <!-- Skill Match Summary -->
                                                        {% if 'Skills' in best_match.matching_criteria %}
                                                        <div class="d-flex align-items-center mb-2">
                                                            <i class="fas fa-tools text-success me-2"></i>
                                                            <span class="small">
                                                                <span class="fw-bold">{{ best_match.skill_match_details.exact_matches|length }}</span> exact skill matches
                                                                {% if best_match.skill_match_details.fuzzy_matches %}
                                                                + <span class="fw-bold">{{ best_match.skill_match_details.fuzzy_matches|length }}</span> similar skills
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                        {% endif %}
                                                        
                                                        <!-- Match Score Visualization -->
                                                        <div class="progress mt-2" style="height: 8px; width: 200px;">
                                                            <div class="progress-bar bg-success" 
                                                                role="progressbar" 
                                                                style="width: {% widthratio best_match.match_score 5 100 %}%;" 
                                                                aria-valuenow="{{ best_match.match_score }}" 
                                                                aria-valuemin="0" 
                                                                aria-valuemax="5">
                                                            </div>
                                                        </div>
                                                        {% endwith %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}

                                    <div class="mt-3 row">
                                        <div class="col-12 mb-3 row">
                                            <div class="col-md-6 mb-3">
                                                <label class="fw-bolder" for="skills">Applicant Location</label>
                                                <ul class="list-unstyled mb-0">
                                                    <li>
                                                        <span> {{resume.address}}</span> 
                                                    </li>
                                                </ul>
                                            </div>

                                            <div id="salaryDisplay" class="col-md-6">
                                                {% if resume.salary_display_type == 'fixed' %}
                                                    <label class="fw-bolder" for="skills">Expected Salary</label>
                                                    <ul class="list-unstyled mb-0">
                                                        <li>
                                                            <span> {{ resume.currency }} {{ resume.expt_salary_fixed|intcomma }} {{ resume.expt_salary_mode|title }}</span>
                                                        </li>
                                                    </ul>
                                                {% elif resume.salary_display_type == 'range' %}
                                                    <label class="fw-bolder" for="skills">Expected Salary Range</label>
                                                    <ul class="list-unstyled mb-0">
                                                        <li>
                                                            <span> {{ resume.currency }} {{ resume.expt_salary_min|intcomma }} - {{ resume.currency }} {{ resume.expt_salary_max|intcomma }}  {{ resume.expt_salary_mode|title }}</span>
                                                        </li>
                                                    </ul>
                                                {% elif resume.salary_display_type == 'hidden' %}
                                                    <label class="fw-bolder" for="skills">Expected Salary Information</label>
                                                    <p>Hidden</p>
                                                {% else %}
                                                    <p>No Salary Information Available</p>
                                                {% endif %}
                                            </div>

                                            <hr>

                                            <div class="col-md-6 mb-3">
                                                <label class="fw-bolder" for="skills">Experience</label>
                                                <ul class="list-unstyled mb-0">
                                                    {% for exp in resume.experiences.all %}
                                                        <li>
                                                            <h6 class="mb-1 fw-bold">{{ exp.title }}</h6>
                                                            <p class="mb-1 text-muted">{{ exp.company }}</p>
                                                            <p class="small text-muted">
                                                                {{ exp.start_date|date:"F Y" }} – 
                                                                {% if exp.end_date %}
                                                                    {{ exp.end_date|date:"F Y" }}
                                                                {% else %}
                                                                    Present
                                                                {% endif %}
                                                            </p>
                                                        </li>
                                                    {% empty %}
                                                        <li>No experience listed.</li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label class="fw-bolder" for="skills">Education</label>
                                                <ul class="list-unstyled mb-0">
                                                    {% for edu in resume.education.all %}
                                                    <li class="d-flex align-items-start mb-2">
                                                        <i class="fa-solid fa-graduation-cap mt-1 me-2"></i>
                                                        {% if edu.degree %}
                                                            <div class="d-flex flex-column">
                                                                <span class="fw-semibold">
                                                                    {{ edu.degree|title }}
                                                                </span>
                                                                <span class="text-muted">{{ edu.get_education_level_display }}</span>
                                                            </div>
                                                            
                                                        {% endif %}
                                                        
                                                        
                                                    </li>
                                                    {% empty %}
                                                        <li>No education listed.</li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                        </div>
                                        
                                        <div class="col-12 mb-3 row">
                                            <div class="col-md-6 mb-3">
                                                <label class="fw-bolder" for="skills">Skills</label>
                                            
                                                <div class="d-flex flex-wrap">
                                                    {% with resume.skills.all|slice:":3" as limited_skills %}
                                                        {% for skill in limited_skills %}
                                                            <span class="skillbadge me-2 mb-1">{{ skill.name }}</span>
                                                        {% endfor %}
                                                    {% endwith %}
                                                    
                                                    {% with resume.skills.all.count as total_skills %}
                                                        {% if total_skills > 3 %}
                                                            <span class="skillbadge me-2 mb-1">+{{ total_skills|add:"-3" }} more</span>
                                                        {% endif %}
                                                    {% endwith %}
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <label class="fw-bolder" for="skills">Certifications</label>
                                                <ul class="list-unstyled mb-0">
                                                    {% for cert in resume.certifications.all %}
                                                        <li>- {{ cert.name }}</li>
                                                    {% empty %}
                                                        <li>No certifications listed.</li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="fw-bolder" for="skills">Projects</label>
                                                <ul class="list-unstyled mb-0">
                                                    {% for project in resume.projects.all %}
                                                        <li>
                                                            <strong>{{ project.title }}</strong><br>
                                                            {% if project.url %}
                                                                <a href="{{ project.url }}" target="_blank">View Project</a>
                                                            {% endif %}
                                                        </li>
                                                        <li> {{ project.description|slice:":20" }}{% if project.description|length > 20 %}...{% endif %}</li>
                                                    {% empty %}
                                                        <li>No projects listed.</li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="fw-bolder" for="skills">Social Links</label>
                                                <ul class="list-unstyled mb-0">
                                                    {% for link in resume.social_links.all %}
                                                        <li>
                                                            <strong>{{link.platform}}:</strong>
                                                            <a href="{{link.url}}" target="_blank">{{ link.url }}</a>
                                                        </li>
                                                    {% empty %}
                                                        <li>No social links provided.</li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                        
                                    
                                </div>
                            </div>
                        {% empty %}
                            <div class="customAlert alert alert-danger text-center shadow" role="alert" style="padding: 5rem; margin-bottom: 10vh;">
                                <img src="{% static 'images/undraw_no_data_re_kwbl.svg' %}" class="mb-4" width="150" height="150" alt="">
                                <h3>No results found.</h3>
                                {% if request.GET.name %} for "{{ request.GET.name }}"{% endif %}
                                {% if request.GET.address %} in "{{ request.GET.address }}"{% endif %}
                                {% if request.GET.industry %} under "{{ request.GET.industry }}" industry{% endif %}
                                {% if request.GET.employment_job_type %} with employment type "{{ request.GET.employment_job_type }}"{% endif %}
                                {% if request.GET.education_level %} with education level "{{ request.GET.education_level }}"{% endif %}
                                <p class="mt-2">Please adjust your filters and try again.</p>
                            </div>
                        {% endfor %}
                    </div>

                    <!-- Right Column: Job Management -->
                    <div class="col-md-4 p-4">
                        <h3 class="mb-4">Job Management</h3>
                        <!-- Quick Actions Card -->
                        <div class="card recommendation-card mb-3 p-3">
                            <div class="card-body">
                                <h5 class="card-title mb-3">Quick Actions</h5>
                                <div class="d-grid gap-2">
                                    <a href="{% url 'create-job' %}" class="btn btn-primary customButton">Post a New Job</a>
                                </div>
                            </div>
                        </div>

                        <!-- Manage Jobs Card -->
                        <div class="card recommendation-card mb-3 p-3">
                            <div class="card-body">
                                <h5 class="card-title">Manage Jobs</h5>
                                <p class="text-muted">View and edit your active job listings.</p>
                                <a href="{% url 'manage-jobs' %}" class="btn btn-primary customButton px-3">Manage Jobs</a>
                            </div>
                        </div>
                        <!-- Job Analytics Card -->
                        <div class="card recommendation-card mb-3 p-3">
                            <div class="card-body">
                                <h5 class="card-title">Job Analytics</h5>
                                <p class="text-muted">Track performance of your job postings.</p>
                                <a href="{% url 'job-analytics' %}" class="btn btn-primary customButton px-3">View Analytics</a>
                            </div>
                        </div>
                    </div>
                </div>
        {% endif %}
    </div>
    {% endif %}

    <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content"  style="border-radius: 1rem;">
                <div class="modal-header bg-primary text-white"  style="border-top-left-radius: 1rem; border-top-right-radius: 1rem;">
                    <h5 class="modal-title" id="confirmModalLabel">Confirm Action</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <div id="confirmIcon" class="mb-3">
                        <i class="bi bi-exclamation-circle text-warning" style="font-size: 2rem;"></i>
                    </div>
                    <p id="confirmMessage">Are you sure you want to perform this action?</p>
                </div>
                <div class="modal-footer justify-content-end">
                    <button type="button" class="btn customButton btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <a id="confirmActionButton" href="#" class="btn customButton btn-primary">Confirm</a>
                </div>
            </div>
        </div>
    </div>
    

<script>

    document.addEventListener('DOMContentLoaded', function() {
        const salaryTypeSelect = document.getElementById('salaryType');
        const fixedSalaryContainer = document.getElementById('fixedSalaryContainer');
        const salaryRangeContainer = document.getElementById('salaryRangeContainer');
        const minSalaryInput = document.querySelector('input[name="min_salary"]');
        const maxSalaryInput = document.querySelector('input[name="max_salary"]');

        function updateSalaryInputs() {
            const selectedType = salaryTypeSelect.value;
            
            // Hide all containers first
            fixedSalaryContainer.style.display = 'none';
            salaryRangeContainer.style.display = 'none';
            
            // Reset all inputs
            minSalaryInput.value = '';
            maxSalaryInput.value = '';

            // Show appropriate container based on selection
            if (selectedType === 'fixed') {
                fixedSalaryContainer.style.display = 'block';
                minSalaryInput.placeholder = "Enter Fixed Salary";
            } else if (selectedType === 'range') {
                salaryRangeContainer.style.display = 'flex';
                minSalaryInput.placeholder = "Min Salary";
                maxSalaryInput.placeholder = "Max Salary";
            }
            // If 'hidden' or empty selection, all containers remain hidden
        }

        salaryTypeSelect.addEventListener('change', updateSalaryInputs);
        
        // Run on page load to handle pre-selected values
        updateSalaryInputs();
    });

    function showConfirmModal({ title, message, actionUrl, theme = "primary", icon = "exclamation-circle" }) {
        document.getElementById("confirmModalLabel").textContent = title;
        document.getElementById("confirmMessage").textContent = message;
        document.getElementById("confirmActionButton").href = actionUrl;

        // Update icon dynamically
        document.getElementById("confirmIcon").innerHTML = `<i class="bi bi-${icon} text-${theme}" style="font-size: 2rem;"></i>`;

        // Update modal header background
        document.querySelector("#confirmModal .modal-header").className = `modal-header bg-${theme} text-white`;
        
        // Update button color
        document.getElementById("confirmActionButton").className = `btn btn-${theme}`;

        // Show modal
        new bootstrap.Modal(document.getElementById("confirmModal")).show();
    }


    // Helper function to get CSRF token
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

{% endblock content %}